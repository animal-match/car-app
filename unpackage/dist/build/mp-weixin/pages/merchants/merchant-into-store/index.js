(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/merchants/merchant-into-store/index"],{"2d41":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(o("a34a"));function s(t){return t&&t.__esModule?t:{default:t}}function i(t,e,o,n,s,i,u){try{var a=t[i](u),r=a.value}catch(c){return void o(c)}a.done?e(r):Promise.resolve(r).then(n,s)}function u(t){return function(){var e=this,o=arguments;return new Promise((function(n,s){var u=t.apply(e,o);function a(t){i(u,n,s,a,r,"next",t)}function r(t){i(u,n,s,a,r,"throw",t)}a(void 0)}))}}var a={data:function(){return{storeType:0,isCollection:0,iconName:"star",starStatus:!1,phoneNoShow:!1,phoneTips:"",adressTips:"",isvip:!1,idValue:"",userLoginId:"",goodsTags:[],productions:[],storeInformation:{},showMessageBtn:!1,store:{longitude:"",latitude:"",phoneNo:"",address:""},myStoreType:null}},onLoad:function(t){this.idValue=t.id,this.storeInfo(t.id)},onShow:function(){this.showMessageBtn=1==this.$store.state.config.message,console.log("按钮显示",this.$store.state.config.message),this.userLoginId=this.$store.state.user.userId,this.isvip=t.getStorageSync("isVip"),this.adressTips=this.$store.state.config.one_money,this.myStoreType=this.$store.state.user.type,console.log("登录人的商家类型",this.myStoreType),this.getPhoneAddr()},computed:{phoneContent:function(){return 0===this.myStoreType&&1===this.storeType?"厂家查看经销商电话或地址需支付".concat(this.adressTips,"元费用"):1===this.myStoreType&&0===this.storeType?"非会员查看电话或地址需成为会员":void 0}},methods:{collecting:function(){var e=t.getStorageSync("token");e?(this.starStatus=!this.starStatus,!0===this.starStatus?(this.iconName="star-fill",this.collectStore()):(this.iconName="star",this.collectStore())):t.showToast({icon:"none",title:"请登录后操作"})},collectStore:function(){var e=this;this.$request({url:!0===this.starStatus?"/api/likes/add":"/api/likes/delete",method:"POST",data:{store_id:this.idValue},success:function(o){if(1!=o.code)return t.showToast({icon:"none",title:o.msg}),!1;t.showToast({icon:!0===e.starStatus?"success":"none",title:!0===e.starStatus?"收藏店铺成功":"已取消收藏"})}})},getPhoneAddr:function(){var e=this;return u(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,e.$request({url:"/api/store/getAddress",method:"POST",data:{store_id:e.idValue},success:function(o){return 1!=o.code?(t.showToast({icon:"none",title:o.msg,duration:3e3}),console.log("还没有满足条件"),"需给商家留言三次并且被回复才能查看地址与电话"===o.msg&&(e.phoneNoShow=!1,console.log("关闭弹窗")),!1):(console.log("拿到了电话地址等信息",o.data),e.store.phoneNo=o.data.phone,e.store.address=o.data.address,e.store.longitude=o.data.long,e.store.latitude=o.data.lat,"success")}});case 2:case"end":return o.stop()}}),o)})))()},storeInfo:function(e){var o=this;this.$request({url:"/api/store/detail",method:"POST",data:{store_id:e},success:function(e){if(0===e.code)return t.showToast({icon:"none",title:e.msg,duration:3e3}),!1;o.goodsTags=e.data.category,o.productions=e.data.goods,o.storeInformation=e.data,o.storeType=e.data.type,o.isCollection=e.data.is_likes,1===o.isCollection?(o.starStatus=!0,o.iconName="star-fill"):(o.iconName="star",o.starStatus=!1)}})},showPhone:function(e){var o;o=0!==this.myStoreType&&1!==this.myStoreType,o?t.showToast({icon:"none",title:"您还未入住商家"}):this.myStoreType!==this.storeType?e||this.userLoginId==this.idValue?t.makePhoneCall({phoneNumber:e,success:function(t){}}):(this.phoneNoShow=!0,this.getPhoneAddr()):t.showToast({icon:"none",title:"同类型商家不能查看"})},showAddress:function(e,o,n){var s;console.log("商家类型2：",this.myStoreType),s=0!==this.myStoreType&&1!==this.myStoreType,s?t.showToast({icon:"none",title:"您还未入住商家"}):this.myStoreType!==this.storeType?e||o||n||this.userLoginId==this.idValue?t.getLocation({type:"wgs84",success:function(s){console.log("商家位置的经纬度",s),"getLocation:ok"===s.errMsg&&t.openLocation({latitude:Number(o),longitude:Number(e),address:n,scale:18,success:function(){console.log("定位成功")}})},fail:function(e){"getLocation:fail auth deny"===e.errMsg&&t.showModal({content:"检测到您没打开获取信息功能权限，是否去设置打开？",confirmText:"确认",cancelText:"取消",success:function(e){if(!e.confirm)return!1;t.openSetting({success:function(t){}})}})}}):(this.phoneNoShow=!0,this.getPhoneAddr()):t.showToast({icon:"none",title:"同类型商家不能查看"})},payment:function(){var e;e=0===this.myStoreType&&1===this.storeType?this.adressTips:this.$store.state.config.s_vip_money,t.navigateTo({url:"/pages/merchants/payment/index?money="+e+"&storeId="+this.idValue})},toMySupply:function(){t.navigateTo({url:"/pages/me/my-supply-info/index"})},sendMessage:function(){t.navigateTo({url:"sendMessage?id="+this.idValue+"&type="+this.storeType})}}};e.default=a}).call(this,o("543d")["default"])},3763:function(t,e,o){"use strict";o.r(e);var n=o("2d41"),s=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=s.a},4300:function(t,e,o){"use strict";var n=o("e6a7"),s=o.n(n);s.a},"7b9e":function(t,e,o){"use strict";o.r(e);var n=o("9b66"),s=o("3763");for(var i in s)"default"!==i&&function(t){o.d(e,t,(function(){return s[t]}))}(i);o("4300");var u,a=o("f0c5"),r=Object(a["a"])(s["default"],n["b"],n["c"],!1,null,"7456dd63",null,!1,n["a"],u);e["default"]=r.exports},"9b66":function(t,e,o){"use strict";o.d(e,"b",(function(){return s})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return n}));var n={uImage:function(){return o.e("node-modules/uview-ui/components/u-image/u-image").then(o.bind(null,"7583"))},uIcon:function(){return o.e("node-modules/uview-ui/components/u-icon/u-icon").then(o.bind(null,"5165"))},uButton:function(){return o.e("node-modules/uview-ui/components/u-button/u-button").then(o.bind(null,"8626"))},uTag:function(){return o.e("node-modules/uview-ui/components/u-tag/u-tag").then(o.bind(null,"48c1"))},uGap:function(){return o.e("node-modules/uview-ui/components/u-gap/u-gap").then(o.bind(null,"dd55"))},uModal:function(){return o.e("node-modules/uview-ui/components/u-modal/u-modal").then(o.bind(null,"51d3"))}},s=function(){var t=this,e=t.$createElement;t._self._c},i=[]},"9d65":function(t,e,o){"use strict";(function(t){o("e3e7");n(o("66fd"));var e=n(o("7b9e"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},e6a7:function(t,e,o){}},[["9d65","common/runtime","common/vendor"]]]);